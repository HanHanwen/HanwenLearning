# OverView

​	过渡操作使得我们可以根据索引大小，文档数和使用期限自动过渡到新索引。触发翻转后，将创建新索引，写别名将更新指向新索引，所有后续更新都将写入新索引。



​	与基于时间的过渡相比，基于大小、文档数和使用期限过渡至新索引更可取。在任意时间翻转通常会导致许多小的索引，这可能会对性能和资源使用产生负面影响。



​	我们可以指定一个或多个过渡参数来控制何时触发过渡动作。一旦满足任意条件，就会执行翻转。由于会定期检查标准，因此索引可能会略微超出指定的阀值。要控制检查标准的频率，可以通过指定集群`indices.lifecycle.poll_interval`设置。



​	通过过渡创建的新索引不会自动继承旧索引使用的策略，并且默认情况下不会使用任何策略。 因此，强烈建议通过索引模板（`包括过渡别名设置`）为索引应用策略，该模板指定要为每个新索引使用的策略。



​	索引翻转后，索引生命周期管理将使用`翻转操作的时间戳`而不是`索引创建时间`来评估何时将索引移至下一个阶段。对于已滚动的索引，为某个阶段指定的`min_age`标准与索引的过渡时间有关。在下面的例子中，索引将在过渡后30天而不是在创建索引后30天删除。

```json
PUT /_ilm/policy/my_policy
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size": "25GB"
          }
        }
      },
      "delete": {
        "min_age": "30d",					//索引将在过渡后30天被删除
        "actions": {
          "delete": {}
        }
      }
    }
  }
}
```



# Skipping Rollover

​	`index.lifecycle.indexing_complete`设置用于指示索引生命周期管理此索引是否已经翻转，若是将其设置为`true`，则表明该索引已经被翻转，不需要再次翻转。从而，索引生命周期管理将跳过在关联的生命周期策略中为此索引配置的任何过渡操作。

​	当我们需要对正常的生命周期进行特殊处理，`并手动将别名切换到其他索引`，但是又不想从索引生命周期管理中完全删除该索引，则这个很有用。



​	如果在索引上将`index.lifecycle.indexing_complete`设置为`true`，则索引生命周期管理不会将其翻转，但是索引生命周期管理将验证该索引不再是`index.lifecycle.rollover_alias`指定的别名的写索引。如果缺少该设置，或者索引仍然是该别名的写入索引，则该索引将移至错误步骤。



​	例如，如果要更改新索引的名称，同时根据配置的策略保留先前的数据，则可以手动创建新索引名称模式的模板和具有新名称的第一个索引，并更改使用`Index Aliases API`创建别名，并在旧索引上将`index.lifecycle.indexing_complete`设置为`true`，以指示不需要将其翻转。 这样，索引生命周期管理将继续按照其现有策略以及新策略继续管理旧索引，而不会中断。

